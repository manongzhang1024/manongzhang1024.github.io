<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ruoyi学习笔记（一） | 旅人小站</title><meta name="keywords" content="ruoyi"><meta name="author" content="Ryan Tian"><meta name="copyright" content="Ryan Tian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ruoyi学习笔记（一）简介 本次学习代码为ruoyi前后端分离版本,资料来源于网络和ruoyi官网api：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1zm4y1A7yQ ps：感谢王清江老师  RuoYi 是一个 Java EE 企业级快速开发平台，基于经典技术组合（Spring Boot、Apache Shiro、MyBatis、Thymeleaf、Bootstrap）">
<meta property="og:type" content="article">
<meta property="og:title" content="ruoyi学习笔记（一）">
<meta property="og:url" content="https://ryantian96.github.io/2023/01/11/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/index.html">
<meta property="og:site_name" content="旅人小站">
<meta property="og:description" content="ruoyi学习笔记（一）简介 本次学习代码为ruoyi前后端分离版本,资料来源于网络和ruoyi官网api：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1zm4y1A7yQ ps：感谢王清江老师  RuoYi 是一个 Java EE 企业级快速开发平台，基于经典技术组合（Spring Boot、Apache Shiro、MyBatis、Thymeleaf、Bootstrap）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s1.ax1x.com/2023/01/11/pSn8BVJ.jpg">
<meta property="article:published_time" content="2023-01-11T09:12:16.000Z">
<meta property="article:modified_time" content="2023-01-11T09:15:08.645Z">
<meta property="article:author" content="Ryan Tian">
<meta property="article:tag" content="ruoyi">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.ax1x.com/2023/01/11/pSn8BVJ.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ryantian96.github.io/2023/01/11/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ruoyi学习笔记（一）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-01-11 17:15:08'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s1.ax1x.com/2022/05/08/O8Agt1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s1.ax1x.com/2023/01/11/pSn8BVJ.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">旅人小站</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ruoyi学习笔记（一）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-01-11T09:12:16.000Z" title="发表于 2023-01-11 17:12:16">2023-01-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-01-11T09:15:08.645Z" title="更新于 2023-01-11 17:15:08">2023-01-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java/">java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ruoyi学习笔记（一）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ruoyi学习笔记（一）"><a href="#ruoyi学习笔记（一）" class="headerlink" title="ruoyi学习笔记（一）"></a>ruoyi学习笔记（一）</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote>
<p>本次学习代码为ruoyi前后端分离版本,资料来源于网络和ruoyi官网api：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1zm4y1A7yQ">https://www.bilibili.com/video/BV1zm4y1A7yQ</a></p>
<p>ps：感谢王清江老师</p>
</blockquote>
<p><strong>RuoYi</strong> 是一个 Java EE 企业级快速开发平台，基于经典技术组合（Spring Boot、Apache Shiro、MyBatis、Thymeleaf、Bootstrap），内置模块如：部门管理、角色用户、菜单及按钮授权、数据权限、系统参数、日志管理、通知公告等。在线定时任务配置；支持集群，支持多数据源，支持分布式事务。</p>
<p>若依官网：<a target="_blank" rel="noopener" href="http://ruoyi.vip/">http://ruoyi.vip</a></p>
<p><strong>主要特性</strong></p>
<ul>
<li>完全响应式布局（支持电脑、平板、手机等所有主流设备）</li>
<li>强大的一键生成功能（包括控制器、模型、视图、菜单等）</li>
<li>支持多数据源，简单配置即可实现切换。</li>
<li>支持按钮及数据权限，可自定义部门数据权限。</li>
<li>对常用js插件进行二次封装，使js代码变得简洁，更加易维护</li>
<li>完善的XSS防范及脚本过滤，彻底杜绝XSS攻击</li>
<li>Maven多项目依赖，模块及插件分项目，尽量松耦合，方便模块升级、增减模块。</li>
<li>国际化支持，服务端及客户端支持</li>
<li>完善的日志记录体系简单注解即可实现</li>
<li>支持服务监控，数据监控，缓存监控功能。</li>
</ul>
<p><strong>技术选型</strong></p>
<p><strong>1、系统环境</strong></p>
<ul>
<li>Java EE 8</li>
<li>Servlet 3.0</li>
<li>Apache Maven 3</li>
</ul>
<p><strong>2、主框架</strong></p>
<ul>
<li>Spring Boot 2.2.x</li>
<li>Spring Framework 5.2.x</li>
<li>Apache Shiro 1.7</li>
</ul>
<p><strong>3、持久层</strong></p>
<ul>
<li>Apache MyBatis 3.5.x</li>
<li>Hibernate Validation 6.0.x</li>
<li>Alibaba Druid 1.2.x</li>
</ul>
<p><strong>4、视图层</strong></p>
<ul>
<li>Bootstrap 3.3.7</li>
<li>Thymeleaf 3.0.x</li>
</ul>
<h2 id="1-快速开始"><a href="#1-快速开始" class="headerlink" title="1.快速开始"></a>1.快速开始</h2><p>下载地址：<a target="_blank" rel="noopener" href="https://gitee.com/y_project/RuoYi-Vue/repository/archive/master.zip">https://gitee.com/y_project/RuoYi-Vue/repository/archive/master.zip</a></p>
<p>下载代码并解压，将RuoYi-Vue-master解压后文件夹内的ruoyi-ui（前端部分）剪切出来放置于平级目录</p>
<h3 id="1-1后端启动"><a href="#1-1后端启动" class="headerlink" title="1.1后端启动"></a>1.1后端启动</h3><p>idea打开RuoYi-Vue-master,在数据库中执行该目录下的sql文件夹中的<strong>ry_20220822.sql</strong>和<strong>quartz.sql</strong>文件。</p>
<p>修改ruo-yi-admin下的配置文件<strong>application-druid.yml</strong>中的数据库配置为自己的本机配置。</p>
<p>修改完配置后，启动redis（如果有密码也要在上面配置文件中修改）</p>
<p>最后，启动RuoYiApplication</p>
<h3 id="1-2前端启动"><a href="#1-2前端启动" class="headerlink" title="1.2前端启动"></a>1.2前端启动</h3><p>在settings-plugins里提前装上vue插件</p>
<p>在idea（或者dos进入根目录）的terminal中安装vue依赖,然后就可以直接运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//安装依赖</span><br><span class="line">npm install</span><br><span class="line">//运行项目</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>



<p>启动成功并进入登录页面：</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230104115208310.png" alt="image-20230104115208310"></p>
<h2 id="2-云服务部署"><a href="#2-云服务部署" class="headerlink" title="2.云服务部署"></a>2.云服务部署</h2><p>这里我使用的是腾讯云，为了简化操作，系统安装了宝塔linux7.9.3</p>
<p>登录宝塔页面，如果登录失败可以在防火墙配置放行端口，宝塔默认端口8888</p>
<p><a href="http://ip:port/tencentcloud">http://ip:port/tencentcloud</a></p>
<p>远程登录云服务器，执行下方命令获取宝塔管理员用户名和密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/bt default</span><br></pre></td></tr></table></figure>

<p>登录宝塔页面，安装redis、nginx最新版本、mysql5.7版本、java项目管理器</p>
<h3 id="2-1配置数据库"><a href="#2-1配置数据库" class="headerlink" title="2.1配置数据库"></a>2.1配置数据库</h3><p>在宝塔页面进入左侧数据库菜单，新建mysql数据库，命名为ruoyi-vue，访问权限改为所有人，编码默认即可</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230104143733709.png" alt="image-20230104143733709"></p>
<p>在首页选择redis，在性能调整中配置redis密码，将bind绑定的ip由原来的127.0.0.1改为0.0.0.0，之后重载配置</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230104161015648.png" alt="image-20230104161015648"></p>
<h3 id="2-2部署服务"><a href="#2-2部署服务" class="headerlink" title="2.2部署服务"></a>2.2部署服务</h3><p>在idea的maven中选择项目根目录的lifecycle，先点击clean确保target目录无内容，再点击package打包，将jar包上传到服务器</p>
<p>进入上传目录，执行以下命令，运行jar包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar ruoyi-admin.jar &amp;</span><br></pre></td></tr></table></figure>

<p>停止命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//查看端口</span><br><span class="line">jps</span><br><span class="line">netstat -lnp|grep java</span><br><span class="line">kill -9 +port（bootstrap）</span><br></pre></td></tr></table></figure>



<h3 id="2-3配置nginx"><a href="#2-3配置nginx" class="headerlink" title="2.3配置nginx"></a>2.3配置nginx</h3><p>完整配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">user  www www;</span><br><span class="line">worker_processes auto;</span><br><span class="line">error_log  /www/wwwlogs/nginx_error.log  crit;</span><br><span class="line">pid        /www/server/nginx/logs/nginx.pid;</span><br><span class="line">worker_rlimit_nofile 51200;</span><br><span class="line"></span><br><span class="line">stream &#123;</span><br><span class="line">    log_format tcp_format &#x27;$time_local|$remote_addr|$protocol|$status|$bytes_sent|$bytes_received|$session_time|$upstream_addr|$upstream_bytes_sent|$upstream_bytes_received|$upstream_connect_time&#x27;;</span><br><span class="line">  </span><br><span class="line">    access_log /www/wwwlogs/tcp-access.log tcp_format;</span><br><span class="line">    error_log /www/wwwlogs/tcp-error.log;</span><br><span class="line">    include /www/server/panel/vhost/nginx/tcp/*.conf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">events</span><br><span class="line">    &#123;</span><br><span class="line">        use epoll;</span><br><span class="line">        worker_connections 51200;</span><br><span class="line">        multi_accept on;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">http</span><br><span class="line">    &#123;</span><br><span class="line">        include       mime.types;</span><br><span class="line"><span class="meta prompt_">		#</span><span class="language-bash">include luawaf.conf;</span></span><br><span class="line"></span><br><span class="line">		include proxy.conf;</span><br><span class="line"></span><br><span class="line">        default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">        server_names_hash_bucket_size 512;</span><br><span class="line">        client_header_buffer_size 32k;</span><br><span class="line">        large_client_header_buffers 4 32k;</span><br><span class="line">        client_max_body_size 50m;</span><br><span class="line"></span><br><span class="line">        sendfile   on;</span><br><span class="line">        tcp_nopush on;</span><br><span class="line"></span><br><span class="line">        keepalive_timeout 60;</span><br><span class="line"></span><br><span class="line">        tcp_nodelay on;</span><br><span class="line"></span><br><span class="line">        fastcgi_connect_timeout 300;</span><br><span class="line">        fastcgi_send_timeout 300;</span><br><span class="line">        fastcgi_read_timeout 300;</span><br><span class="line">        fastcgi_buffer_size 64k;</span><br><span class="line">        fastcgi_buffers 4 64k;</span><br><span class="line">        fastcgi_busy_buffers_size 128k;</span><br><span class="line">        fastcgi_temp_file_write_size 256k;</span><br><span class="line">		fastcgi_intercept_errors on;</span><br><span class="line"></span><br><span class="line">        gzip on;</span><br><span class="line">        gzip_min_length  1k;</span><br><span class="line">        gzip_buffers     4 16k;</span><br><span class="line">        gzip_http_version 1.1;</span><br><span class="line">        gzip_comp_level 2;</span><br><span class="line">        gzip_types     text/plain application/javascript application/x-javascript text/javascript text/css application/xml;</span><br><span class="line">        gzip_vary on;</span><br><span class="line">        gzip_proxied   expired no-cache no-store private auth;</span><br><span class="line">        gzip_disable   &quot;MSIE [1-6]\.&quot;;</span><br><span class="line"></span><br><span class="line">        limit_conn_zone $binary_remote_addr zone=perip:10m;</span><br><span class="line">		limit_conn_zone $server_name zone=perserver:10m;</span><br><span class="line"></span><br><span class="line">        server_tokens off;</span><br><span class="line">        access_log off;</span><br><span class="line"></span><br><span class="line">server</span><br><span class="line">    &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name localhost;</span><br><span class="line">        charset utf-8;</span><br><span class="line"></span><br><span class="line">        location /  &#123;</span><br><span class="line">            root /home/try/dist;</span><br><span class="line">            try_files $uri $uri/ /index.html;</span><br><span class="line">            index      index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line"></span><br><span class="line">        location /prod-api/ &#123;</span><br><span class="line">            proxy_set_header Host $http_host;</span><br><span class="line">            proxy_set_header X-Real-IP Sremote_addr;</span><br><span class="line">            proxy_set_header REMOTE-HOST $remote_addr;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">            proxy_pass http://localhost:8080/;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page 500 502 503 504 /50x.html;</span><br><span class="line"></span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">               root	html;</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重启nginx</p>
<p>直接访问域名加80端口即可</p>
<h2 id="3-对请求的封装"><a href="#3-对请求的封装" class="headerlink" title="3.对请求的封装"></a>3.对请求的封装</h2><h3 id="3-1reqeust请求拦截-get"><a href="#3-1reqeust请求拦截-get" class="headerlink" title="3.1reqeust请求拦截(get)"></a>3.1reqeust请求拦截(get)</h3><p>ruoyi的前端对请求发送进行了封装，在&#x2F;src&#x2F;utils路径下的request.js文件中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (config.<span class="property">method</span> === <span class="string">&#x27;get&#x27;</span> &amp;&amp; config.<span class="property">params</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> url = config.<span class="property">url</span> + <span class="string">&#x27;?&#x27;</span> + <span class="title function_">tansParams</span>(config.<span class="property">params</span>);</span><br><span class="line">    url = url.<span class="title function_">slice</span>(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">    config.<span class="property">params</span> = &#123;&#125;;</span><br><span class="line">    config.<span class="property">url</span> = url;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 参数处理</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; params  参数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">tansParams</span>(<span class="params">params</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> propName <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(params)) &#123;</span><br><span class="line">    <span class="keyword">const</span> value = params[propName];</span><br><span class="line">    <span class="keyword">var</span> part = <span class="built_in">encodeURIComponent</span>(propName) + <span class="string">&quot;=&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (value !== <span class="literal">null</span> &amp;&amp; value !== <span class="string">&quot;&quot;</span> &amp;&amp; <span class="keyword">typeof</span> (value) !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(value)) &#123;</span><br><span class="line">          <span class="keyword">if</span> (value[key] !== <span class="literal">null</span> &amp;&amp; value[key] !== <span class="string">&quot;&quot;</span> &amp;&amp; <span class="keyword">typeof</span> (value[key]) !== <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> params = propName + <span class="string">&#x27;[&#x27;</span> + key + <span class="string">&#x27;]&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> subPart = <span class="built_in">encodeURIComponent</span>(params) + <span class="string">&quot;=&quot;</span>;</span><br><span class="line">            result += subPart + <span class="built_in">encodeURIComponent</span>(value[key]) + <span class="string">&quot;&amp;&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result += part + <span class="built_in">encodeURIComponent</span>(value) + <span class="string">&quot;&amp;&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的方法在发送get请求时，将参数定义为params(object)，再发送请求时会转换为get请求的格式</p>
<blockquote>
<p>查看请求时学到了一个小技巧，在f12调试的时候点击XHR可以过滤为只查看ajax请求</p>
</blockquote>
<h3 id="3-2发送一个get请求"><a href="#3-2发送一个get请求" class="headerlink" title="3.2发送一个get请求"></a>3.2发送一个get请求</h3><p>（copy一个请求，替换一下，模拟请求开发流程）</p>
<p>ruoyi的请求写在了&#x2F;src&#x2F;api目录下，新建一个test文件夹，新建js文件testRequest,以查询在线用户列表接口为例:</p>
<p>&#x3D;&#x3D;testRequest.js&#x3D;&#x3D;</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询在线用户列表</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">list1</span>(<span class="params">query</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;test request&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/monitor/online/list&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: query</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里加了一个log打印,然后在vue页面中替换这个请求</p>
<p>引入这个js，并调用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;list1&#125; <span class="keyword">from</span> <span class="string">&quot;@/api/test/testRequest&quot;</span>;</span><br><span class="line"><span class="comment">//methods</span></span><br><span class="line"><span class="comment">/** 查询登录日志列表 */</span></span><br><span class="line">    <span class="title function_">getList</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="title function_">list1</span>(<span class="variable language_">this</span>.<span class="property">queryParams</span>).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">list</span> = response.<span class="property">rows</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">total</span> = response.<span class="property">total</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>成功打印了log:</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230106143842932.png" alt="image-20230106143842932"></p>
<p>ruoyi的在线用户存在了redis中，每次一个人登录，就会把他的登录信息存在redis中。</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230106144654802.png" alt="image-20230106144654802"></p>
<p>从redis信息来看，用户的很多信息都存在了这个登录token中，用户访问的每一个功能都需要校验权限，redis查询可以省不少资源。</p>
<h3 id="3-3reqeust请求拦截-post"><a href="#3-3reqeust请求拦截-post" class="headerlink" title="3.3reqeust请求拦截(post)"></a>3.3reqeust请求拦截(post)</h3><p>request.js中的post处理方法:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!isRepeatSubmit &amp;&amp; (config.<span class="property">method</span> === <span class="string">&#x27;post&#x27;</span> || config.<span class="property">method</span> === <span class="string">&#x27;put&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">const</span> requestObj = &#123;</span><br><span class="line">      <span class="attr">url</span>: config.<span class="property">url</span>,</span><br><span class="line">      <span class="attr">data</span>: <span class="keyword">typeof</span> config.<span class="property">data</span> === <span class="string">&#x27;object&#x27;</span> ? <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(config.<span class="property">data</span>) : config.<span class="property">data</span>,</span><br><span class="line">      <span class="attr">time</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> sessionObj = cache.<span class="property">session</span>.<span class="title function_">getJSON</span>(<span class="string">&#x27;sessionObj&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (sessionObj === <span class="literal">undefined</span> || sessionObj === <span class="literal">null</span> || sessionObj === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">      cache.<span class="property">session</span>.<span class="title function_">setJSON</span>(<span class="string">&#x27;sessionObj&#x27;</span>, requestObj)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> s_url = sessionObj.<span class="property">url</span>;                  <span class="comment">// 请求地址</span></span><br><span class="line">      <span class="keyword">const</span> s_data = sessionObj.<span class="property">data</span>;                <span class="comment">// 请求数据</span></span><br><span class="line">      <span class="keyword">const</span> s_time = sessionObj.<span class="property">time</span>;                <span class="comment">// 请求时间</span></span><br><span class="line">      <span class="keyword">const</span> interval = <span class="number">1000</span>;                         <span class="comment">// 间隔时间(ms)，小于此时间视为重复提交</span></span><br><span class="line">      <span class="keyword">if</span> (s_data === requestObj.<span class="property">data</span> &amp;&amp; requestObj.<span class="property">time</span> - s_time &lt; interval &amp;&amp; s_url === requestObj.<span class="property">url</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> message = <span class="string">&#x27;数据正在处理，请勿重复提交&#x27;</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`[<span class="subst">$&#123;s_url&#125;</span>]: `</span> + message)</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(message))</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cache.<span class="property">session</span>.<span class="title function_">setJSON</span>(<span class="string">&#x27;sessionObj&#x27;</span>, requestObj)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>能看到，若想使用若依的封装，需要把参数命名为data</p>
<p><strong>防止重复提交功能</strong></p>
<p>第一次发送请求时，请求里把当前的时间戳封装在了time属性里</p>
<p>如果时间间隔小于1秒且参数相同，会被判定为重复提交并触发提示</p>
<h3 id="3-4响应拦截器"><a href="#3-4响应拦截器" class="headerlink" title="3.4响应拦截器"></a>3.4响应拦截器</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 未设置状态码则默认成功状态</span></span><br><span class="line">    <span class="keyword">const</span> code = res.<span class="property">data</span>.<span class="property">code</span> || <span class="number">200</span>;</span><br><span class="line">    <span class="comment">// 获取错误信息</span></span><br><span class="line">    <span class="keyword">const</span> msg = errorCode[code] || res.<span class="property">data</span>.<span class="property">msg</span> || errorCode[<span class="string">&#x27;default&#x27;</span>]</span><br><span class="line">    <span class="comment">// 二进制数据则直接返回</span></span><br><span class="line">    <span class="keyword">if</span>(res.<span class="property">request</span>.<span class="property">responseType</span> ===  <span class="string">&#x27;blob&#x27;</span> || res.<span class="property">request</span>.<span class="property">responseType</span> ===  <span class="string">&#x27;arraybuffer&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="property">data</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (code === <span class="number">401</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!isRelogin.<span class="property">show</span>) &#123;</span><br><span class="line">        isRelogin.<span class="property">show</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="title class_">MessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&#x27;登录状态已过期，您可以继续留在该页面，或者重新登录&#x27;</span>, <span class="string">&#x27;系统提示&#x27;</span>, &#123; <span class="attr">confirmButtonText</span>: <span class="string">&#x27;重新登录&#x27;</span>, <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span> &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          isRelogin.<span class="property">show</span> = <span class="literal">false</span>;</span><br><span class="line">          store.<span class="title function_">dispatch</span>(<span class="string">&#x27;LogOut&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            location.<span class="property">href</span> = <span class="string">&#x27;/index&#x27;</span>;</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;).<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        isRelogin.<span class="property">show</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;无效的会话，或者会话已过期，请重新登录。&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code === <span class="number">500</span>) &#123;</span><br><span class="line">      <span class="title class_">Message</span>(&#123; <span class="attr">message</span>: msg, <span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span> &#125;)</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(msg))</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code === <span class="number">601</span>) &#123;</span><br><span class="line">      <span class="title class_">Message</span>(&#123; <span class="attr">message</span>: msg, <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span> &#125;)</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code !== <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="title class_">Notification</span>.<span class="title function_">error</span>(&#123; <span class="attr">title</span>: msg &#125;)</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="property">data</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;err&#x27;</span> + error)</span><br><span class="line">    <span class="keyword">let</span> &#123; message &#125; = error;</span><br><span class="line">    <span class="keyword">if</span> (message == <span class="string">&quot;Network Error&quot;</span>) &#123;</span><br><span class="line">      message = <span class="string">&quot;后端接口连接异常&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message.<span class="title function_">includes</span>(<span class="string">&quot;timeout&quot;</span>)) &#123;</span><br><span class="line">      message = <span class="string">&quot;系统接口请求超时&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message.<span class="title function_">includes</span>(<span class="string">&quot;Request failed with status code&quot;</span>)) &#123;</span><br><span class="line">      message = <span class="string">&quot;系统接口&quot;</span> + message.<span class="title function_">substr</span>(message.<span class="property">length</span> - <span class="number">3</span>) + <span class="string">&quot;异常&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Message</span>(&#123; <span class="attr">message</span>: message, <span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span>, <span class="attr">duration</span>: <span class="number">5</span> * <span class="number">1000</span> &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="3-5通用Excel导出方法"><a href="#3-5通用Excel导出方法" class="headerlink" title="3.5通用Excel导出方法"></a>3.5通用Excel导出方法</h3><p>前端方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 导出按钮操作 */</span></span><br><span class="line">    <span class="title function_">handleExport</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">download</span>(<span class="string">&#x27;system/dict/type/export&#x27;</span>, &#123;</span><br><span class="line">        ...<span class="variable language_">this</span>.<span class="property">queryParams</span></span><br><span class="line">      &#125;, <span class="string">`type_<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()&#125;</span>.xlsx`</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>直接调用的this.download是全局方法，在main.js里查看</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通用下载方法</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">download</span>(<span class="params">url, params, filename, config</span>) &#123;</span><br><span class="line">  downloadLoadingInstance = <span class="title class_">Loading</span>.<span class="title function_">service</span>(&#123; <span class="attr">text</span>: <span class="string">&quot;正在下载数据，请稍候&quot;</span>, <span class="attr">spinner</span>: <span class="string">&quot;el-icon-loading&quot;</span>, <span class="attr">background</span>: <span class="string">&quot;rgba(0, 0, 0, 0.7)&quot;</span>, &#125;)</span><br><span class="line">  <span class="keyword">return</span> service.<span class="title function_">post</span>(url, params, &#123;</span><br><span class="line">    <span class="attr">transformRequest</span>: [<span class="function">(<span class="params">params</span>) =&gt;</span> &#123; <span class="keyword">return</span> <span class="title function_">tansParams</span>(params) &#125;],</span><br><span class="line">    <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">responseType</span>: <span class="string">&#x27;blob&#x27;</span>,</span><br><span class="line">    ...config</span><br><span class="line">  &#125;).<span class="title function_">then</span>(<span class="keyword">async</span> (data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> isLogin = <span class="keyword">await</span> <span class="title function_">blobValidate</span>(data);</span><br><span class="line">    <span class="keyword">if</span> (isLogin) &#123;</span><br><span class="line">      <span class="keyword">const</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>([data])</span><br><span class="line">      <span class="title function_">saveAs</span>(blob, filename)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> resText = <span class="keyword">await</span> data.<span class="title function_">text</span>();</span><br><span class="line">      <span class="keyword">const</span> rspObj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(resText);</span><br><span class="line">      <span class="keyword">const</span> errMsg = errorCode[rspObj.<span class="property">code</span>] || rspObj.<span class="property">msg</span> || errorCode[<span class="string">&#x27;default&#x27;</span>]</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(errMsg);</span><br><span class="line">    &#125;</span><br><span class="line">    downloadLoadingInstance.<span class="title function_">close</span>();</span><br><span class="line">  &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">r</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(r)</span><br><span class="line">    <span class="title class_">Message</span>.<span class="title function_">error</span>(<span class="string">&#x27;下载文件出现错误，请联系管理员！&#x27;</span>)</span><br><span class="line">    downloadLoadingInstance.<span class="title function_">close</span>();</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>element-ui Loading.service</strong></p>
<p>Loading 加载：加载数据时显示动效。</p>
<p><strong>Loading 可以以服务的方式调用。</strong></p>
<p>引入 Loading 服务：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Loading</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>在需要调用时：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Loading</span>.<span class="title function_">service</span>(options);</span><br></pre></td></tr></table></figure>

<p>其中 options 参数为 Loading 的配置项，具体见下表。LoadingService 会返回一个 Loading 实例，可通过调用该实例的 close 方法来关闭它：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> loadingInstance = <span class="title class_">Loading</span>.<span class="title function_">service</span>(options);</span><br><span class="line"><span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123; <span class="comment">// 以服务的方式调用的 Loading 需要异步关闭</span></span><br><span class="line">loadingInstance.<span class="title function_">close</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> loading;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义加载动画</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startLoading</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="comment">// Loading.service(options); options 参数为 Loading 的配置项</span></span><br><span class="line"> <span class="comment">// 使用loading变量来接收Loading.service返回的实例</span></span><br><span class="line"></span><br><span class="line"> loading = <span class="title class_">Loading</span>.<span class="title function_">service</span>(&#123;</span><br><span class="line">     <span class="attr">lock</span>:<span class="literal">true</span>,    <span class="comment">//是否锁定</span></span><br><span class="line">     <span class="attr">text</span>:<span class="string">&quot;拼命加载中...&quot;</span>,   <span class="comment">//显示在加载图标下方的加载文案</span></span><br><span class="line">     <span class="attr">background</span>:<span class="string">&#x27;rgba(0,0,0,.7)&#x27;</span>,   <span class="comment">//遮罩背景色</span></span><br><span class="line"> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//结束加载动画，调用该实例的 close 方法来关闭</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">endLoading</span>(<span class="params"></span>)&#123;</span><br><span class="line"> loading.<span class="title function_">close</span>();</span><br></pre></td></tr></table></figure>


</blockquote>
<blockquote>
<p><strong>Javascript 中三个点的三种用法</strong></p>
<p>如果你阅读或查看现在的Javascript 程序时，大概率会发现省略号出现在很多的地方，这个省略号(…)是在ES6 中引入的一个功能，它看起来很简单很不起眼是不？但是它在 JavaScript 中，非常有用。</p>
<p>举个简单的例子，我们有个字符串 author :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> author = <span class="string">&quot;Bruce&quot;</span></span><br></pre></td></tr></table></figure>

<p>那如何把这个字符串转换成包含所有字符组成的数组呢？</p>
<p>在 C 或 C++ 中，我们需要先创建一个数组，然后使用 for 循环遍历所有字符串，一个一个添加到数组中。</p>
<p>在 Javascript 中，我们只需要一行代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> authorChar = [...author]</span><br></pre></td></tr></table></figure>
</blockquote>
<p>再看下后端这里做了啥</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Log(title = &quot;字典类型&quot;, businessType = BusinessType.EXPORT)</span></span><br><span class="line">    <span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;system:dict:export&#x27;)&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/export&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">export</span><span class="params">(HttpServletResponse response, SysDictType dictType)</span></span><br><span class="line">    &#123;</span><br><span class="line">        List&lt;SysDictType&gt; list = dictTypeService.selectDictTypeList(dictType);</span><br><span class="line">        ExcelUtil&lt;SysDictType&gt; util = <span class="keyword">new</span> <span class="title class_">ExcelUtil</span>&lt;SysDictType&gt;(SysDictType.class);</span><br><span class="line">        util.exportExcel(response, list, <span class="string">&quot;字典类型&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>exportExcel 方法response参数获取输出流</p>
<p>excel导出的关键就在这个方法，首先等号右边用构造方法将要导出的实体类传入生成了一个ExcelUtil方法类对象</p>
<blockquote>
<p>idea工具在debug这里的时候蓝色向下的步进箭头是进入改方法但不进入jdk，红色向下箭头强制进入包括jdk</p>
</blockquote>
<p>exportExcel方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对list数据源将其里面的数据导入到excel表单</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response 返回数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> list 导出数据集合</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheetName 工作表的名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exportExcel</span><span class="params">(HttpServletResponse response, List&lt;T&gt; list, String sheetName)</span></span><br><span class="line">    &#123;</span><br><span class="line">        exportExcel(response, list, sheetName, StringUtils.EMPTY);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>StringUtils.EMPTY值是空字符串（值用作标题）</p>
<p>继续debug</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  *注释和上面相同</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exportExcel</span><span class="params">(HttpServletResponse response, List&lt;T&gt; list, String sheetName, String title)</span></span><br><span class="line">    &#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.init(list, sheetName, title, Type.EXPORT);</span><br><span class="line">        exportExcel(response);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>导出xlsx的Mine type,参考地址:<a target="_blank" rel="noopener" href="https://blog.csdn.net/XUANEER/article/details/108464282">https://blog.csdn.net/XUANEER/article/details/108464282</a></p>
<table>
<thead>
<tr>
<th><strong>File extension</strong></th>
<th><strong>MIME type</strong></th>
</tr>
</thead>
<tbody><tr>
<td>.xlsx</td>
<td>application&#x2F;vnd.openxmlformats-officedocument.spreadsheetml.sheet</td>
</tr>
</tbody></table>
</blockquote>
<p>init方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(List&lt;T&gt; list, String sheetName, String title, Type type)</span></span><br><span class="line"> &#123;</span><br><span class="line">     <span class="keyword">if</span> (list == <span class="literal">null</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;T&gt;();</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="built_in">this</span>.list = list;</span><br><span class="line">     <span class="built_in">this</span>.sheetName = sheetName;</span><br><span class="line">     <span class="built_in">this</span>.type = type;</span><br><span class="line">     <span class="built_in">this</span>.title = title;</span><br><span class="line">     createExcelField();</span><br><span class="line">     createWorkbook();</span><br><span class="line">     createTitle();</span><br><span class="line">     createSubHead();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>对数据进行了判断与空值处理</p>
<p>createExcelField()方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到所有定义字段</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">createExcelField</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.fields = getFields();</span><br><span class="line">        <span class="built_in">this</span>.fields = <span class="built_in">this</span>.fields.stream().sorted(Comparator.comparing(objects -&gt; ((Excel) objects[<span class="number">1</span>]).sort())).collect(Collectors.toList());</span><br><span class="line">        <span class="built_in">this</span>.maxHeight = getRowHeight();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据注解获取最大行高</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">short</span> <span class="title function_">getRowHeight</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">maxHeight</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Object[] os : <span class="built_in">this</span>.fields)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">Excel</span> <span class="variable">excel</span> <span class="operator">=</span> (Excel) os[<span class="number">1</span>];</span><br><span class="line">            maxHeight = Math.max(maxHeight, excel.height());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">short</span>) (maxHeight * <span class="number">20</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>获取到了要导出的表头列名字段，然后获取了steam流进行了排序操作，最后根据列数设置行高</p>
<p>createWorkbook()和createTitle()方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 创建一个工作簿</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createWorkbook</span><span class="params">()</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="built_in">this</span>.wb = <span class="keyword">new</span> <span class="title class_">SXSSFWorkbook</span>(<span class="number">500</span>);</span><br><span class="line">       <span class="built_in">this</span>.sheet = wb.createSheet();</span><br><span class="line">       wb.setSheetName(<span class="number">0</span>, sheetName);</span><br><span class="line">       <span class="built_in">this</span>.styles = createStyles(wb);</span><br><span class="line">   &#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 创建excel第一行标题</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createTitle</span><span class="params">()</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">if</span> (StringUtils.isNotEmpty(title))</span><br><span class="line">       &#123;</span><br><span class="line">           subMergedFirstRowNum++;</span><br><span class="line">           subMergedLastRowNum++;</span><br><span class="line">           <span class="type">int</span> <span class="variable">titleLastCol</span> <span class="operator">=</span> <span class="built_in">this</span>.fields.size() - <span class="number">1</span>;</span><br><span class="line">           <span class="keyword">if</span> (isSubList())</span><br><span class="line">           &#123;</span><br><span class="line">               titleLastCol = titleLastCol + subFields.size() - <span class="number">1</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="type">Row</span> <span class="variable">titleRow</span> <span class="operator">=</span> sheet.createRow(rownum == <span class="number">0</span> ? rownum++ : <span class="number">0</span>);</span><br><span class="line">           titleRow.setHeightInPoints(<span class="number">30</span>);</span><br><span class="line">           <span class="type">Cell</span> <span class="variable">titleCell</span> <span class="operator">=</span> titleRow.createCell(<span class="number">0</span>);</span><br><span class="line">           titleCell.setCellStyle(styles.get(<span class="string">&quot;title&quot;</span>));</span><br><span class="line">           titleCell.setCellValue(title);</span><br><span class="line">           sheet.addMergedRegion(<span class="keyword">new</span> <span class="title class_">CellRangeAddress</span>(titleRow.getRowNum(), titleRow.getRowNum(), titleRow.getRowNum(), titleLastCol));</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>设置了标题字体格式并合并了单元格</p>
<p>export方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 对list数据源将其里面的数据导入到excel表单</span></span><br><span class="line"><span class="comment">    * </span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exportExcel</span><span class="params">(HttpServletResponse response)</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">try</span></span><br><span class="line">       &#123;</span><br><span class="line">           writeSheet();</span><br><span class="line">           wb.write(response.getOutputStream());</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">catch</span> (Exception e)</span><br><span class="line">       &#123;</span><br><span class="line">           log.error(<span class="string">&quot;导出Excel异常&#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">finally</span></span><br><span class="line">       &#123;</span><br><span class="line">           IOUtils.closeQuietly(wb);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 创建写入数据到Sheet</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeSheet</span><span class="params">()</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="comment">// 取出一共有多少个sheet.</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">sheetNo</span> <span class="operator">=</span> Math.max(<span class="number">1</span>, (<span class="type">int</span>) Math.ceil(list.size() * <span class="number">1.0</span> / sheetSize));</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>; index &lt; sheetNo; index++)</span><br><span class="line">       &#123;</span><br><span class="line">           createSheet(sheetNo, index);</span><br><span class="line"></span><br><span class="line">           <span class="comment">// 产生一行</span></span><br><span class="line">           <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(rownum);</span><br><span class="line">           <span class="type">int</span> <span class="variable">column</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">           <span class="comment">// 写入各个字段的列头名称</span></span><br><span class="line">           <span class="keyword">for</span> (Object[] os : fields)</span><br><span class="line">           &#123;</span><br><span class="line">               <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> (Field) os[<span class="number">0</span>];</span><br><span class="line">               <span class="type">Excel</span> <span class="variable">excel</span> <span class="operator">=</span> (Excel) os[<span class="number">1</span>];</span><br><span class="line">               <span class="keyword">if</span> (Collection.class.isAssignableFrom(field.getType()))</span><br><span class="line">               &#123;</span><br><span class="line">                   <span class="keyword">for</span> (Field subField : subFields)</span><br><span class="line">                   &#123;</span><br><span class="line">                       <span class="type">Excel</span> <span class="variable">subExcel</span> <span class="operator">=</span> subField.getAnnotation(Excel.class);</span><br><span class="line">                       <span class="built_in">this</span>.createHeadCell(subExcel, row, column++);</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">else</span></span><br><span class="line">               &#123;</span><br><span class="line">                   <span class="built_in">this</span>.createHeadCell(excel, row, column++);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">if</span> (Type.EXPORT.equals(type))</span><br><span class="line">           &#123;</span><br><span class="line">               fillExcelData(index, row);</span><br><span class="line">               addStatisticsRow();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-6-restful传值方式"><a href="#3-6-restful传值方式" class="headerlink" title="3.6.restful传值方式"></a>3.6.restful传值方式</h3><p>restful风格在ruoyi中的使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据参数编号获取详细信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;system:config:query&#x27;)&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/&#123;configId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">getInfo</span><span class="params">(<span class="meta">@PathVariable</span> Long configId)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> success(configService.selectConfigById(configId));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>restful的一个特点是在路径中传参</p>
<h2 id="4-可配置信息"><a href="#4-可配置信息" class="headerlink" title="4.可配置信息"></a>4.可配置信息</h2><h3 id="4-1验证码开关"><a href="#4-1验证码开关" class="headerlink" title="4.1验证码开关"></a>4.1验证码开关</h3><p>我们打开页面“参数管理”，所谓参数管理，就是在系统运行起来的时候，可以动态修改一些值，这些值会被系统实时修改，下次如果需要读值，则会是最新的值。</p>
<p>对于验证码而言，可以将下面的参数值修改为false即可：</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230110152204382.png" alt="image-20230110152204382"></p>
<p>实现原理</p>
<p>前端代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getCode</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="title function_">getCodeImg</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">captchaOnOff</span> = res.<span class="property">captchaOnOff</span> === <span class="literal">undefined</span> ? <span class="literal">true</span> : res.<span class="property">captchaOnOff</span>;</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">captchaOnOff</span>) &#123;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">codeUrl</span> = <span class="string">&quot;data:image/gif;base64,&quot;</span> + res.<span class="property">img</span>;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">loginForm</span>.<span class="property">uuid</span> = res.<span class="property">uuid</span>;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>后端代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@GetMapping(&quot;/captchaImage&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">getCode</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException</span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">AjaxResult</span> <span class="variable">ajax</span> <span class="operator">=</span> AjaxResult.success();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">captchaOnOff</span> <span class="operator">=</span> configService.selectCaptchaOnOff();</span><br><span class="line">        ajax.put(<span class="string">&quot;captchaOnOff&quot;</span>, captchaOnOff);</span><br><span class="line">        <span class="keyword">if</span> (!captchaOnOff)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ajax;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 保存验证码信息</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> IdUtils.simpleUUID();</span><br><span class="line">        <span class="type">String</span> <span class="variable">verifyKey</span> <span class="operator">=</span> CacheConstants.CAPTCHA_CODE_KEY + uuid;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">capStr</span> <span class="operator">=</span> <span class="literal">null</span>, code = <span class="literal">null</span>;</span><br><span class="line">        <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成验证码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">captchaType</span> <span class="operator">=</span> RuoYiConfig.getCaptchaType();</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;math&quot;</span>.equals(captchaType))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">capText</span> <span class="operator">=</span> captchaProducerMath.createText();</span><br><span class="line">            capStr = capText.substring(<span class="number">0</span>, capText.lastIndexOf(<span class="string">&quot;@&quot;</span>));</span><br><span class="line">            code = capText.substring(capText.lastIndexOf(<span class="string">&quot;@&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">            image = captchaProducerMath.createImage(capStr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;char&quot;</span>.equals(captchaType))</span><br><span class="line">        &#123;</span><br><span class="line">            capStr = code = captchaProducer.createText();</span><br><span class="line">            image = captchaProducer.createImage(capStr);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        redisCache.setCacheObject(verifyKey, code, Constants.CAPTCHA_EXPIRATION, TimeUnit.MINUTES);</span><br><span class="line">        <span class="comment">// 转换流信息写出</span></span><br><span class="line">        <span class="type">FastByteArrayOutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FastByteArrayOutputStream</span>();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            ImageIO.write(image, <span class="string">&quot;jpg&quot;</span>, os);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ajax.put(<span class="string">&quot;uuid&quot;</span>, uuid);</span><br><span class="line">        ajax.put(<span class="string">&quot;img&quot;</span>, Base64.encode(os.toByteArray()));</span><br><span class="line">        <span class="keyword">return</span> ajax;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-PostContruct"><a href="#4-2-PostContruct" class="headerlink" title="4.2@PostContruct"></a>4.2@PostContruct</h3><p>ruoyi将配置信息存在redis是在项目启动时做的：</p>
<p><code>@PostContruct</code>是spring框架的注解，在方法上加该注解会在<strong>项目启动的时候</strong>执行该方法，也可以理解为在spring容器<strong>初始化的时候</strong>执行该方法。</p>
<p>从Java EE5规范开始，Servlet中增加了两个影响Servlet生命周期的注解，<code>@PostConstruct</code>和<code>@PreDestroy</code>，这两个注解被用来修饰一个<strong>非静态的void（）方法</strong>。</p>
<p>用法:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostContruct</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">// ....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@PostContruct</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">// ....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>执行顺序</strong></p>
<p>其实从依赖注入的字面意思就可以知道，要将对象b注入到对象a，那么首先就必须得生成对象a和对象b，才能执行注入。所以，如果一个类A中有个成员变量b被<code>@Autowried</code>注解，那么<code>@Autowired</code>注入是发生在A的<strong>构造方法执行完之后</strong>的。</p>
<p>如果想在生成对象时完成某些初始化操作，而偏偏这些初始化操作又依赖于依赖注入，那么久无法在构造函数中实现。为此，可以使用<code>@PostConstruct</code>注解一个方法来完成初始化，<code>@PostConstruct</code>注解的方法将会在<strong>依赖注入完成后</strong>被自动调用。</p>
<blockquote>
<p>Constructor &gt;&gt; @Autowired &gt;&gt; @PostConstruct<br>构造方法 &gt;&gt; 依赖注入 &gt;&gt; 后期构造</p>
</blockquote>
<h3 id="4-3用户初始密码"><a href="#4-3用户初始密码" class="headerlink" title="4.3用户初始密码"></a>4.3用户初始密码</h3><p>在修改参数中可以修改新用户初始密码</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230110160356359.png" alt="image-20230110160356359"></p>
<h3 id="4-4ip开关"><a href="#4-4ip开关" class="headerlink" title="4.4ip开关"></a>4.4ip开关</h3><p>在系统监控的在线用户子菜单中，能看到当前登录用户的信息，登录地点默认是关闭的，此时展示的地点是<code>xx.xx</code>，在yml文件中可以修改该配置</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230110160717318.png" alt="image-20230110160717318"></p>
<p>打开ip地址之后查看登录记录</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230110163915696.png" alt="image-20230110163915696"></p>
<p>ip地址转换成登录地点的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getRealAddressByIP</span><span class="params">(String ip)</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="comment">// 内网不查询</span></span><br><span class="line">       <span class="keyword">if</span> (IpUtils.internalIp(ip))</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;内网IP&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (RuoYiConfig.isAddressEnabled())</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">try</span></span><br><span class="line">           &#123;</span><br><span class="line">               <span class="type">String</span> <span class="variable">rspStr</span> <span class="operator">=</span> HttpUtils.sendGet(IP_URL, <span class="string">&quot;ip=&quot;</span> + ip + <span class="string">&quot;&amp;json=true&quot;</span>, Constants.GBK);</span><br><span class="line">               <span class="keyword">if</span> (StringUtils.isEmpty(rspStr))</span><br><span class="line">               &#123;</span><br><span class="line">                   log.error(<span class="string">&quot;获取地理位置异常 &#123;&#125;&quot;</span>, ip);</span><br><span class="line">                   <span class="keyword">return</span> UNKNOWN;</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="type">JSONObject</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parseObject(rspStr);</span><br><span class="line">               <span class="type">String</span> <span class="variable">region</span> <span class="operator">=</span> obj.getString(<span class="string">&quot;pro&quot;</span>);</span><br><span class="line">               <span class="type">String</span> <span class="variable">city</span> <span class="operator">=</span> obj.getString(<span class="string">&quot;city&quot;</span>);</span><br><span class="line">               <span class="keyword">return</span> String.format(<span class="string">&quot;%s %s&quot;</span>, region, city);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">catch</span> (Exception e)</span><br><span class="line">           &#123;</span><br><span class="line">               log.error(<span class="string">&quot;获取地理位置异常 &#123;&#125;&quot;</span>, ip);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> UNKNOWN;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>其中，HttpUtils.sendGet()方法用来查询ip地址，调用的外部接口地址为<code>http://whois.pconline.com.cn/ipJson.jsp</code></p>
<p>用户登录的时候会调用这个方法来记录登录地址</p>
<h3 id="4-5vue浏览器插件问题"><a href="#4-5vue浏览器插件问题" class="headerlink" title="4.5vue浏览器插件问题"></a>4.5vue浏览器插件问题</h3><p>chrome浏览器扩展程序中安装了vue的DevTools，f12调试时发现打不开功能，提示如下</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230110173129351.png" alt="image-20230110173129351"></p>
<p>这个有两种情况：</p>
<ul>
<li>使用 html 引入 vue.js 的时候</li>
<li>使用 webpack 用 npm 直接引用 vue 模块的时候</li>
</ul>
<p><strong>html 引入 vue.js</strong></p>
<p>把引入的文件改为 <code>vue.js</code> 而不是 <code>vue.min.js</code></p>
<p><strong>使用 webpack 的时候，也就是使用 .vue 单文件的时候</strong></p>
<p>需要在引入 vue 组件的时候，配置一下 vue<br>main.js文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">devtools</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure>



<h2 id="5-前端页面的布局"><a href="#5-前端页面的布局" class="headerlink" title="5.前端页面的布局"></a>5.前端页面的布局</h2><h3 id="5-1不依赖Layout的情况"><a href="#5-1不依赖Layout的情况" class="headerlink" title="5.1不依赖Layout的情况"></a>5.1不依赖Layout的情况</h3><p><strong>Layout的概念：</strong></p>
<blockquote>
<p>Layout components are used to wrap pages. Layouts should contain components like headers, footers or sidebars that will be used across the site.</p>
<p>Layouts are just .vue components located in src&#x2F;layouts and need to be declared as a global component or imported per page to be used.</p>
<p>Every layout requires a <slot> component. This is where the content coming from pages and templates will be inserted. Layouts can have multiple slots.</slot></p>
<p>Layout 组件用于包装页面。Layout 应包含将在整个站点中使用的页眉、页脚或边栏等组件。</p>
<p>Layouts只是位于src&#x2F;Layouts中的.vue组件，需要声明为全局组件或按要使用的页面导入。</p>
<p>每个布局都需要一个＜slot＞组件。这是来自页面和模板的内容将被插入的位置。Layout 可以有多个slot。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Layout --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line"> &lt;header /&gt;</span><br><span class="line"> &lt;slot&gt;&lt;/slot&gt; &lt;!-- Page content will be inserted here --&gt;</span><br><span class="line"> &lt;footer /&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>登录页面，注册页面，404页面就不依赖于layout组件，layout组件实际上就是一个vue的组件。</p>
<p>这种组件比较简单，就是跟写HTML基本也没啥两样。</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230110180005932.png" alt="image-20230110180005932"></p>
<h3 id="5-2依赖Layout组件"><a href="#5-2依赖Layout组件" class="headerlink" title="5.2依赖Layout组件"></a>5.2依赖Layout组件</h3><p>当我们成功登录，接下来基本上每一个页面都是出于Layout组件之下，也就是说，它是layout组件的子组件！</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230111142048699.png" alt="image-20230111142048699"></p>
<p>此时此刻的组件树如上。</p>
<p>Sidebar：对应左边菜单区。</p>
<p>Navbar：导航区。</p>
<p>TagsView：页签区。</p>
<p>RightPanel：右面板区，平常不可见。</p>
<p>AppMain：内容页面区，我们一般业务页面会出现在此区域。</p>
<h2 id="6-前端的路由守卫"><a href="#6-前端的路由守卫" class="headerlink" title="6.前端的路由守卫"></a>6.前端的路由守卫</h2><h3 id="6-1路由守卫"><a href="#6-1路由守卫" class="headerlink" title="6.1路由守卫"></a><strong>6.1路由守卫</strong></h3><p>比如说，当点击商城的购物车的时候，需要判断一下是否登录，如果没有登录，就跳转到登录页面，如果登陆了，就跳转到<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%B4%AD%E7%89%A9%E8%BD%A6%E9%A1%B5%E9%9D%A2&spm=1001.2101.3001.7020">购物车页面</a>，相当于有一个守卫在安检</p>
<p>路由守卫有三种：<br>1：全局钩子： beforeEach、 afterEach<br>2：独享守卫（单个路由里面的钩子）： beforeEnter、 beforeLeave<br>3：组件内守卫：beforeRouteEnter、 beforeRouteUpdate、 beforeRouteLeave</p>
<p><strong>全局守卫</strong></p>
<p>router.beforeEach() 进入之前触发</p>
<p>router.afterEach() 进入之后触发<br>每个守卫方法接收三个参数：</p>
<p>①to: Route: 即将要进入的目标路由对象（to是一个对象，是将要进入的路由对象，可以用to.path调用路由对象中的属性）</p>
<p>②from: Route: 当前导航正要离开的路由</p>
<p>③next: Function: 这是一个必须需要调用的方法，执行效果依赖 next 方法的调用参数。</p>
<p><strong>前置路由守卫（每次切换前被调用）</strong></p>
<p>首先先在需要配置路由守卫的地方加上 meta: { isAuth: true }</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/Home.vue&#x27;</span>),</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">isAuth</span>: <span class="literal">true</span>, <span class="attr">title</span>:<span class="string">&#x27;主页&#x27;</span> &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全局前置路由守卫————初始化的时候被调用、每次路由切换之前被调用</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//如果路由需要跳转</span></span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">isAuth</span>) &#123;</span><br><span class="line">        <span class="comment">//判断 如果school本地存储是qinghuadaxue的时候，可以进去</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;school&#x27;</span>) === <span class="string">&#x27;qinghuadaxue&#x27;</span>) &#123;</span><br><span class="line">            <span class="title function_">next</span>()  <span class="comment">//放行</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;抱歉，您无权限查看！&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 否则，放行</span></span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<p><strong>后置路由守卫（每次切换后被调用）</strong></p>
<p>是路由跳转之后执行的事件，可以用作跳转路由后更改网页名</p>
<p>首先路由的meta需要配置title的名字</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">       <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">       <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">       <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/Home.vue&#x27;</span>),</span><br><span class="line">       <span class="attr">meta</span>: &#123; <span class="attr">isAuth</span>: <span class="literal">true</span>, <span class="attr">title</span>:<span class="string">&#x27;主页&#x27;</span> &#125;,</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全局后置路由守卫————初始化的时候被调用、每次路由切换之后被调用</span></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = to.<span class="property">meta</span>.<span class="property">title</span> || <span class="string">&#x27;默认名&#x27;</span>    <span class="comment">//修改网页的title</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<p><strong>独享路由守卫（某一个路由所单独享用的路由守卫）</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../views/Home.vue&#x27;</span>),</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">isAuth</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    <span class="attr">beforeEnter</span>: <span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">isAuth</span>) &#123; <span class="comment">//判断是否需要授权</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;school&#x27;</span>) === <span class="string">&#x27;qinghuadaxue&#x27;</span>) &#123;</span><br><span class="line">                <span class="title function_">next</span>()  <span class="comment">//放行</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&#x27;抱歉，您无权限查看！&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">next</span>()  <span class="comment">//放行</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<p><strong>组件内守卫</strong></p>
<p>独享路由守卫只有前置没有后置，直接写在.vue文件中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过路由规则，进入该组件时被调用</span></span><br><span class="line"><span class="title function_">beforeRouteEnter</span>(<span class="params">to,<span class="keyword">from</span>,next</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(toString.<span class="property">meta</span>.<span class="property">isAuth</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getTime</span>(<span class="string">&#x27;school&#x27;</span>)===<span class="string">&#x27;qinghuadaxue&#x27;</span>)&#123;</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&#x27;学校名不对，无权限查看！&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"> </span><br><span class="line"><span class="comment">//通过路由规则，离开该组件时被调用 </span></span><br><span class="line"><span class="title function_">beforeRouteLeave</span>(<span class="params">to,<span class="keyword">from</span>,next</span>) &#123;</span><br><span class="line"> <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6-2若依的路由守卫"><a href="#6-2若依的路由守卫" class="headerlink" title="6.2若依的路由守卫"></a>6.2若依的路由守卫</h3><p>路径：src&#x2F;permission.js</p>
<p>登录 注册页面写入了白名单里</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> whiteList = [<span class="string">&#x27;/login&#x27;</span>, <span class="string">&#x27;/auth-redirect&#x27;</span>, <span class="string">&#x27;/bind&#x27;</span>, <span class="string">&#x27;/register&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">//前置路由守卫</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">start</span>()</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">getToken</span>()) &#123;</span><br><span class="line">    to.<span class="property">meta</span>.<span class="property">title</span> &amp;&amp; store.<span class="title function_">dispatch</span>(<span class="string">&#x27;settings/setTitle&#x27;</span>, to.<span class="property">meta</span>.<span class="property">title</span>)</span><br><span class="line">    <span class="comment">/* has token*/</span></span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">path</span> === <span class="string">&#x27;/login&#x27;</span>) &#123;</span><br><span class="line">      <span class="title function_">next</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span> &#125;)</span><br><span class="line">      <span class="title class_">NProgress</span>.<span class="title function_">done</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">roles</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        isRelogin.<span class="property">show</span> = <span class="literal">true</span></span><br><span class="line">        <span class="comment">// 判断当前用户是否已拉取完user_info信息</span></span><br><span class="line">        store.<span class="title function_">dispatch</span>(<span class="string">&#x27;GetInfo&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          isRelogin.<span class="property">show</span> = <span class="literal">false</span></span><br><span class="line">          store.<span class="title function_">dispatch</span>(<span class="string">&#x27;GenerateRoutes&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">accessRoutes</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 根据roles权限生成可访问的路由表</span></span><br><span class="line">            router.<span class="title function_">addRoutes</span>(accessRoutes) <span class="comment">// 动态添加可访问路由表</span></span><br><span class="line">            <span class="title function_">next</span>(&#123; ...to, <span class="attr">replace</span>: <span class="literal">true</span> &#125;) <span class="comment">// hack方法 确保addRoutes已完成</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            store.<span class="title function_">dispatch</span>(<span class="string">&#x27;LogOut&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="title class_">Message</span>.<span class="title function_">error</span>(err)</span><br><span class="line">              <span class="title function_">next</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span> &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 没有token</span></span><br><span class="line">    <span class="keyword">if</span> (whiteList.<span class="title function_">indexOf</span>(to.<span class="property">path</span>) !== -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">// 在免登录白名单，直接进入</span></span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="string">`/login?redirect=<span class="subst">$&#123;to.fullPath&#125;</span>`</span>) <span class="comment">// 否则全部重定向到登录页</span></span><br><span class="line">      <span class="title class_">NProgress</span>.<span class="title function_">done</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//后置路由守卫</span></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">done</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在前置路由守卫里判断了有没有登录</p>
<h2 id="7-新增菜单"><a href="#7-新增菜单" class="headerlink" title="7.新增菜单"></a>7.新增菜单</h2><p>直接在views文件夹下面新增weather.vue。然后随便写一个123，现在先让我们页面能跳过去先。</p>
<p>让页面能跳过去，有好几种方法：</p>
<p>1、在菜单管理自己添加一个菜单，然后把菜单分配给某个角色，再把该角色分给某个人。【然而超级管理员什么时候都能看到此菜单，因为超级管理员能无视一切权限问题】</p>
<p>2、在路由文件（router&#x2F;index.js直接写相关路由），然后可以手动切换浏览器网址进入该路由。</p>
<p>进入系统管理-&gt;菜单管理</p>
<p>demo流程：</p>
<p>在views下新增文件夹test，test下新增weather.vue</p>
<p><strong>新增菜单</strong></p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230111160649188.png" alt="image-20230111160649188"></p>
<p><strong>新增组件</strong></p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230111160457666.png" alt="image-20230111160457666"></p>
<p>刷新：</p>
<p><img src="https://raw.githubusercontent.com/RyanTian96/cloudimg/master/imgimage-20230111160846509.png" alt="image-20230111160846509"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://ryantian96.github.io">Ryan Tian</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://ryantian96.github.io/2023/01/11/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/">https://ryantian96.github.io/2023/01/11/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://ryantian96.github.io" target="_blank">旅人小站</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ruoyi/">ruoyi</a></div><div class="post_share"><div class="social-share" data-image="https://s1.ax1x.com/2023/01/11/pSn8BVJ.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/29/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"><img class="prev-cover" src="https://s1.ax1x.com/2023/01/11/pSn8BVJ.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ruoyi学习笔记（二）</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/23/word%E5%AE%8F%E5%88%86%E4%BA%AB-%E9%80%89%E4%B8%AD%E6%89%80%E6%9C%89%E8%A1%A8%E6%A0%BC%E5%92%8C%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%E7%BB%9F%E4%B8%80%E5%A4%84%E7%90%86/"><img class="next-cover" src="https://s1.ax1x.com/2022/08/06/vu3UiR.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">word宏分享-选中所有表格和图片大小统一处理</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/01/29/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" title="ruoyi学习笔记（二）"><img class="cover" src="https://s1.ax1x.com/2023/01/11/pSn8BVJ.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-29</div><div class="title">ruoyi学习笔记（二）</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s1.ax1x.com/2022/05/08/O8Agt1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Ryan Tian</div><div class="author-info__description">羁旅长堪醉，相留畏晓钟</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/RyanTian96"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Welcome to my blog~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">ruoyi学习笔记（一）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B"><span class="toc-number">1.2.</span> <span class="toc-text">1.快速开始</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E5%90%8E%E7%AB%AF%E5%90%AF%E5%8A%A8"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.1后端启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E5%89%8D%E7%AB%AF%E5%90%AF%E5%8A%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2前端启动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%BA%91%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2"><span class="toc-number">1.3.</span> <span class="toc-text">2.云服务部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1配置数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.2部署服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3%E9%85%8D%E7%BD%AEnginx"><span class="toc-number">1.3.3.</span> <span class="toc-text">2.3配置nginx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%AF%B9%E8%AF%B7%E6%B1%82%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-number">1.4.</span> <span class="toc-text">3.对请求的封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1reqeust%E8%AF%B7%E6%B1%82%E6%8B%A6%E6%88%AA-get"><span class="toc-number">1.4.1.</span> <span class="toc-text">3.1reqeust请求拦截(get)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AAget%E8%AF%B7%E6%B1%82"><span class="toc-number">1.4.2.</span> <span class="toc-text">3.2发送一个get请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3reqeust%E8%AF%B7%E6%B1%82%E6%8B%A6%E6%88%AA-post"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.3reqeust请求拦截(post)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">1.4.4.</span> <span class="toc-text">3.4响应拦截器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5%E9%80%9A%E7%94%A8Excel%E5%AF%BC%E5%87%BA%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.5.</span> <span class="toc-text">3.5通用Excel导出方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-restful%E4%BC%A0%E5%80%BC%E6%96%B9%E5%BC%8F"><span class="toc-number">1.4.6.</span> <span class="toc-text">3.6.restful传值方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8F%AF%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="toc-number">1.5.</span> <span class="toc-text">4.可配置信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1%E9%AA%8C%E8%AF%81%E7%A0%81%E5%BC%80%E5%85%B3"><span class="toc-number">1.5.1.</span> <span class="toc-text">4.1验证码开关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-PostContruct"><span class="toc-number">1.5.2.</span> <span class="toc-text">4.2@PostContruct</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3%E7%94%A8%E6%88%B7%E5%88%9D%E5%A7%8B%E5%AF%86%E7%A0%81"><span class="toc-number">1.5.3.</span> <span class="toc-text">4.3用户初始密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4ip%E5%BC%80%E5%85%B3"><span class="toc-number">1.5.4.</span> <span class="toc-text">4.4ip开关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5vue%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.5.</span> <span class="toc-text">4.5vue浏览器插件问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E7%9A%84%E5%B8%83%E5%B1%80"><span class="toc-number">1.6.</span> <span class="toc-text">5.前端页面的布局</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1%E4%B8%8D%E4%BE%9D%E8%B5%96Layout%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">1.6.1.</span> <span class="toc-text">5.1不依赖Layout的情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2%E4%BE%9D%E8%B5%96Layout%E7%BB%84%E4%BB%B6"><span class="toc-number">1.6.2.</span> <span class="toc-text">5.2依赖Layout组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%89%8D%E7%AB%AF%E7%9A%84%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB"><span class="toc-number">1.7.</span> <span class="toc-text">6.前端的路由守卫</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB"><span class="toc-number">1.7.1.</span> <span class="toc-text">6.1路由守卫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2%E8%8B%A5%E4%BE%9D%E7%9A%84%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB"><span class="toc-number">1.7.2.</span> <span class="toc-text">6.2若依的路由守卫</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%96%B0%E5%A2%9E%E8%8F%9C%E5%8D%95"><span class="toc-number">1.8.</span> <span class="toc-text">7.新增菜单</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/01/29/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" title="ruoyi学习笔记（二）"><img src="https://s1.ax1x.com/2023/01/11/pSn8BVJ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ruoyi学习笔记（二）"/></a><div class="content"><a class="title" href="/2023/01/29/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" title="ruoyi学习笔记（二）">ruoyi学习笔记（二）</a><time datetime="2023-01-29T09:19:21.000Z" title="发表于 2023-01-29 17:19:21">2023-01-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/11/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" title="ruoyi学习笔记（一）"><img src="https://s1.ax1x.com/2023/01/11/pSn8BVJ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ruoyi学习笔记（一）"/></a><div class="content"><a class="title" href="/2023/01/11/ruoyi%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" title="ruoyi学习笔记（一）">ruoyi学习笔记（一）</a><time datetime="2023-01-11T09:12:16.000Z" title="发表于 2023-01-11 17:12:16">2023-01-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/23/word%E5%AE%8F%E5%88%86%E4%BA%AB-%E9%80%89%E4%B8%AD%E6%89%80%E6%9C%89%E8%A1%A8%E6%A0%BC%E5%92%8C%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%E7%BB%9F%E4%B8%80%E5%A4%84%E7%90%86/" title="word宏分享-选中所有表格和图片大小统一处理"><img src="https://s1.ax1x.com/2022/08/06/vu3UiR.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="word宏分享-选中所有表格和图片大小统一处理"/></a><div class="content"><a class="title" href="/2022/09/23/word%E5%AE%8F%E5%88%86%E4%BA%AB-%E9%80%89%E4%B8%AD%E6%89%80%E6%9C%89%E8%A1%A8%E6%A0%BC%E5%92%8C%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%E7%BB%9F%E4%B8%80%E5%A4%84%E7%90%86/" title="word宏分享-选中所有表格和图片大小统一处理">word宏分享-选中所有表格和图片大小统一处理</a><time datetime="2022-09-23T10:41:55.000Z" title="发表于 2022-09-23 18:41:55">2022-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/02/Hibernate%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%AD%A6%E4%B9%A0/" title="Hibernate配置文件学习"><img src="https://s1.ax1x.com/2022/06/11/Xcbg3t.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hibernate配置文件学习"/></a><div class="content"><a class="title" href="/2022/09/02/Hibernate%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%AD%A6%E4%B9%A0/" title="Hibernate配置文件学习">Hibernate配置文件学习</a><time datetime="2022-09-02T05:48:18.000Z" title="发表于 2022-09-02 13:48:18">2022-09-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/01/Hibernate%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" title="Hibernate学习笔记（一）"><img src="https://s1.ax1x.com/2022/06/11/Xcbg3t.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hibernate学习笔记（一）"/></a><div class="content"><a class="title" href="/2022/09/01/Hibernate%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" title="Hibernate学习笔记（一）">Hibernate学习笔记（一）</a><time datetime="2022-09-01T08:16:07.000Z" title="发表于 2022-09-01 16:16:07">2022-09-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Ryan Tian</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="8471733119" data-server="tencent" data-type="playlist" data-fixed="true" volume=0.5 data-autoplay="false" data-mini="true"> </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>